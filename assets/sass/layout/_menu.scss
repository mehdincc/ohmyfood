@use "../base/global" as *;

/* =========================
   PAGE MENU – La palette du goût
   ========================= */
body.is-menu { background: $color-white; }

/* Header spécifique (flèche retour) */
.is-menu .of-header__brand { position: relative; }
.is-menu .of-back {
  position: absolute;
  left: 20px;
  top: 50%;
  transform: translateY(-50%);
  color: $color-text;
  font-size: 20px;
  text-decoration: none;
  display: flex;
  align-items: center;
  @include smooth-transition(color);
  &:hover { color: $color-primary; }
}

/* Bannière restaurant */
.of-menu-banner {
  height: 230px;
  img { width: 100%; height: 100%; object-fit: cover; display: block; }
}

/* Feuille du menu (débord arrondi) */
.of-menu {
  position: relative;
  margin-top: -60px;
  background: $color-light;
  border-radius: 40px 40px 0 0;
  padding: 30px 16px 40px;
}

/* =========================
   Titre + Cœur (PAGE MENU)
   ========================= */
/* --- Mobile par défaut --- */
.of-menu__head{
  position: relative;
  display: flex;
  justify-content: space-between;
}

.of-menu__title{
  @include menu-title;
  color: $color-black;
  margin: 0;
  text-align: center;
  /* Empêche le chevauchement avec le cœur quand l’écran est très étroit */
  max-width: calc(100% - 56px);
}

/* Cœur local en mobile : collé à droite dans le header */
.of-menu__head .of-like{
  position: absolute;
  top: 4px;
  right: 16px;
  width: 24px;
  height: 24px;
  display: grid;
  place-items: center;
  background: transparent;
  border: 0;
  cursor: pointer;

  /* On neutralise tous héritages possibles du .of-like global */
  left: auto; bottom: auto;
}
.of-menu__head .of-like .of-like__empty,
.of-menu__head .of-like .of-like__full{
  font-size: 22px;
  line-height: 1;
  transition: opacity .28s ease, transform .18s ease;
  pointer-events: none;
}
.of-menu__head .of-like .of-like__empty{ color: $color-black; opacity: 1; }
.of-menu__head .of-like .of-like__full{
  opacity: 0;
  background: $gradient-primary;
  -webkit-background-clip: text;
          background-clip: text;
  -webkit-text-fill-color: transparent;
}
.of-menu__head .of-like:hover .of-like__full{ opacity: 1; }
.of-menu__head .of-like:hover .of-like__empty{ opacity: 0; }

/* --- Tablette et + : titre centré + cœur à sa droite, gap 20px --- */
@media (min-width: $bp-tablet){
  .of-menu{
    width: min(100%, 1055px);
    margin: -60px auto 0;
    padding: 30px 32px 40px;
  }

  .of-menu__head{
    justify-content: center;
  }
  .of-menu__head .of-like {
    width: 27%;
  }

  .of-menu__title{ text-align: center; max-width: none; }
}

/* =========================
   Sections (Entrées / Plats / Desserts)
   ========================= */
.of-course{ margin-top: 24px; margin-bottom: 40px; }

.of-course__title{
  font-family: $font-main; font-weight: 300; font-size: 16px; line-height: 1;
  text-transform: uppercase; color: $color-black; margin: 0;
}
.of-course__bar{
  display: block; width: 40px; height: 3px; background: $color-tertiary;
  border-radius: 3px; margin-top: 10px; margin-bottom: 12px;
}

/* Liste des plats */
.of-dishes{ list-style: none; display: grid; gap: 12px; }

/* Carte plat */
.of-dish{
  display: grid;
  grid-template-columns: 1fr auto 0; /* texte | prix | check (masqué) */
  align-items: stretch;
  max-width: 634px;
  min-height: $card-h;
  background: $color-white;
  border-radius: $card-radius;
  box-shadow: $card-shadow;
  overflow: hidden;
  opacity: 0; transform: translateY(8px);
  animation: dishIn .45s ease forwards;
  transition: grid-template-columns .25s ease, transform .18s ease;

  &:hover{
    grid-template-columns: 1fr auto $check-w;
    transform: translateY(0) scale(1.01);
  }
}

/* (on enlève les anciens nth-child ici) */

@keyframes dishIn{ to{ opacity:1; transform:translateY(0);} }

.of-dish__content{ padding: 15px 7px 15px 15px; min-width: 0; }
.of-dish__name{ @include dish-name; color:$color-black; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; margin-bottom:5px; }
.of-dish__desc{ @include dish-desc; color:$color-black; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.of-dish__price{
  align-self:end; padding:0 15px 15px 0; @include dish-price;
  background:transparent; border-left:1px solid transparent;
  transition: background .25s ease, padding .25s ease, border-color .25s ease;
}

/* Panneau vert + coche */
.of-dish__check{
  display:grid; place-items:center; width:100%; height:100%;
  background:$color-tertiary; color:$color-white;
  border-top-right-radius:$card-radius; border-bottom-right-radius:$card-radius;
  opacity:0; transition:opacity .2s ease; position:relative;
  &::before{
    content:""; position:absolute; width:20px; height:20px; background:$color-white;
    border-radius:50%; box-shadow:0 2px 4px rgba(0,0,0,.12);
    top:50%; left:50%; transform:translate(-50%,-50%);
  }
  i{ position:relative; z-index:1; color:$color-tertiary; font-size:14px; transition:transform .35s ease; }
}
.of-dish:hover .of-dish__check{ opacity:1; }
.of-dish:hover .of-dish__price{ padding-left:12px; }
.of-dish:hover .of-dish__content{ padding-right:4px; }

/* Colonne centrée tablette+ */
@media (min-width: $bp-tablet){
  .of-course{ max-width:634px; margin:24px auto 40px; }
  .of-course__bar{ margin-left:0; }
  .of-dishes{ max-width:634px; margin:0 auto; }
  .of-dish{ width:100%; max-width:634px; }
}
.of-menu__cta {
  display: flex;
  align-items: center;
  flex-direction: column;
}

/* ===== Apparition après loader (2.5s) + cascade ===== */
/* On réutilise $loader-time défini dans _global.scss ou _loader.scss importé */
$first-offset: .2s;   // 1re carte à 0.2s après la fin du loader
$stagger: .3s;        // décalage entre chaque carte

@for $i from 1 through 12 {
  .of-dishes > .of-dish:nth-child(#{$i}) {
    animation-delay: ($loader-time + $first-offset) + ($stagger * ($i - 1));
  }
}

/* Accessibilité : si animations réduites, on affiche direct */
@media (prefers-reduced-motion: reduce) {
  .of-dish { animation: none !important; opacity: 1 !important; transform: none !important; }
}

